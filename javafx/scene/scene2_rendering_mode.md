# 图形渲染模式

2023-07-06, 11:18
****
Scene graph 在屏幕上呈现 JavaFX 应用起着至关重要的作用。

在屏幕上渲染图形的 API 有两类：

- 即时模式
- 保留模式

在**即时模式**，应用负责执行绘图命令，图形直接渲染到屏幕。当需要重新渲染时，应用进程需要重新向屏幕发出绘图命令。Java2D 为即时模式。

在**保留模式**，应用负责创建 graph。图形库（graphics library）将 graph 保留在内存，在需要时将 graph 渲染到屏幕。应用代码只负责创建 graph（what），图形库负责保存和渲染 graph（when and how）。保留模式渲染 API 将开发人员从渲染图形工作中解放出来。

对比即时模式，保留模式占用更多内存。但是使用更简单，JavaFX scene graph 使用保留模式。下图是这两种 API 的示意图：

![|400](Pasted%20image%2020230706111657.png)

JavaFX 这种保留模式对游戏开发不太好，因为游戏开发需要绝对控制渲染，通常会创建自己的游戏循环。在其中控制渲染。

这在 JavaFX 中无法实现，因为 scene graph 最高更新频率为额60 fps，没有办法修改这个渲染过程。另外，与即时渲染模式相比，scene graph 会有额外开销，从而影响性能。scene graph 包含的 nodes 越多，需要的算力和内存越大。

可以想象，如何你创建一个包含大量图形元素的复杂控件，该控件在使用时很可能降低程序性能。为了解决该问题，JavaFX 提供了 Canvas。

在 Canvas 单个 Node 上可以绘制复杂的图形，而渲染速率依然是 60 fps。
